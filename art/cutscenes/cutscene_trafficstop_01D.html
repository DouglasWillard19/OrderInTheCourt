<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OITC – Traffic Stop · 01D</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <style>
    :root {
      --bg: #000000;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      width: 100%;
      background: #000;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: stretch;
      min-height: 100vh;
    }

    .app-window {
      position: relative;
      width: 100vw;
      height: 100vh;
      max-width: 100vw;
      max-height: 100vh;
      overflow: hidden;
      background: #000;
    }

    .app-window img {
      width: 100%;
      height: 100%;
      object-fit: contain;   /* same behavior as 01 */
      background: #000;
      display: block;
    }

    .panel {
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.3s linear;
    }

    .panel.visible {
      opacity: 1;
    }

    /* z-ordering */
    #panel2 { z-index: 3; }  /* CS0002 on top initially */
    #panel3 { z-index: 1; }  /* CS0003 underneath */
    #panel4 { z-index: 2; }  /* CS0004 page-turn overlay */
    #andy   { z-index: 4; }  /* blackout on top at the end */

    /* Break + fall animation for CS0002 */
    .break-fall {
      animation: breakFall 0.6s ease-in forwards;
    }

    @keyframes breakFall {
      0% {
        transform: scale(1) translateY(0) rotate(0deg);
        opacity: 1;
        filter: none;
      }
      10% {
        transform: scale(1.02) translateY(-2vh) rotate(-1deg);
      }
      20% {
        transform: scale(1.03) translateY(1vh) rotate(1.5deg);
      }
      30% {
        transform: scale(1.05) translateY(-1vh) rotate(-2deg);
      }
      40% {
        transform: scale(1.05) translateY(0) rotate(0deg);
      }
      100% {
        transform: scale(1.1) translateY(40vh) rotate(8deg);
        opacity: 0;
        filter: blur(2px);
      }
    }

    /* Page-turn for CS0004 */
    #panel4 {
      clip-path: inset(0 0 0 100%); /* start fully hidden */
    }

    .page-turn-from-3 {
      animation: pageTurn4 2.5s ease-in-out forwards;
    }

    @keyframes pageTurn4 {
      from { clip-path: inset(0 0 0 100%); }  /* hidden off right */
      to   { clip-path: inset(0 0 0 0); }     /* fully visible */
    }
  </style>
</head>
<body>
  <div class="app-window">
    <!-- CS0002: shows first, then breaks/falls -->
    <img id="panel2" class="panel visible"
         src="./I-CS0002.jpg"
         alt="Traffic stop concept art panel I-CS0002" />

    <!-- CS0003: revealed behind CS0002 -->
    <img id="panel3" class="panel"
         src="./I-CS0003.jpg"
         alt="Traffic stop concept art panel I-CS0003" />

    <!-- CS0004: page-turn in over CS0003 -->
    <img id="panel4" class="panel"
         src="./I-CS0004.jpg"
         alt="Traffic stop concept art panel I-CS0004" />

    <!-- Blackout Andy -->
    <img id="andy" class="panel"
         src="./blackoutandy.jpg"
         alt="Blackout Andy" />
  </div>

  <script>
    const p2   = document.getElementById('panel2');
    const p3   = document.getElementById('panel3');
    const p4   = document.getElementById('panel4');
    const andy = document.getElementById('andy');

    // t = 1s: reveal CS0003 behind, break + fall CS0002
    setTimeout(() => {
      p3.classList.add('visible');   // CS0003 appears
      p2.classList.add('break-fall'); // CS0002 breaks/falls

      // after break animation, hide CS0002
      setTimeout(() => {
        p2.classList.remove('visible');
      }, 600); // match breakFall duration
    }, 1000);

    // t = 4s: start page-turn CS0003 -> CS0004
    setTimeout(() => {
      p4.classList.add('visible');
      p4.classList.add('page-turn-from-3');
    }, 4000);

    // t = 6.5s: after page-turn completes, hide CS0003
    setTimeout(() => {
      p3.classList.remove('visible');
    }, 6500);

    // t = 9.5s: hide CS0004, show blackout Andy
    setTimeout(() => {
      p4.classList.remove('visible');
      andy.classList.add('visible');
    }, 9500);
  </script>
</body>
</html>
